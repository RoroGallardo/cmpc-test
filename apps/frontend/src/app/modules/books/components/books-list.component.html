<div class="books-container">
  <div class="header">
    <h1>Gesti√≥n de Libros</h1>
    <button class="btn btn-primary" (click)="createBook()">
      <i class="icon-plus"></i> Nuevo Libro
    </button>
  </div>

  <!-- Filtros -->
  <div class="filters-card">
    <h3>Filtros</h3>
    <form [formGroup]="filterForm">
      <div class="filters-grid">
        <div class="form-group">
          <label for="search">Buscar</label>
          <input
            type="text"
            id="search"
            formControlName="search"
            class="form-control"
            placeholder="Buscar por t√≠tulo..."
          />
        </div>

        <div class="form-group">
          <label for="genreId">G√©nero</label>
          <select id="genreId" formControlName="genreId" class="form-control">
            <option value="">Todos</option>
            <option *ngFor="let genre of genres" [value]="genre.id">{{ genre.name }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="authorId">Autor</label>
          <select id="authorId" formControlName="authorId" class="form-control">
            <option value="">Todos</option>
            <option *ngFor="let author of authors" [value]="author.id">{{ author.name }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="publisherId">Editorial</label>
          <select id="publisherId" formControlName="publisherId" class="form-control">
            <option value="">Todas</option>
            <option *ngFor="let publisher of publishers" [value]="publisher.id">{{ publisher.name }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="available">Disponibilidad</label>
          <select id="available" formControlName="available" class="form-control">
            <option value="">Todos</option>
            <option value="true">Disponibles</option>
            <option value="false">No disponibles</option>
          </select>
        </div>
      </div>

      <div class="filter-actions">
        <button type="button" class="btn btn-secondary" (click)="clearFilters()">
          Limpiar Filtros
        </button>
        <button type="button" class="btn btn-primary" (click)="applyFilters()">
          Aplicar Filtros
        </button>
      </div>
    </form>
  </div>

  <!-- Tabla de libros -->
  <div class="table-card">
    <div class="alert alert-danger" *ngIf="error">{{ error }}</div>
    <div class="loading" *ngIf="loading">Cargando...</div>

    <table class="table" *ngIf="!loading && books.length > 0">
      <thead>
        <tr>
          <th (click)="sortByField('title')" class="sortable">
            T√≠tulo
            <span class="sort-icon" *ngIf="sortBy === 'title'">
              {{ sortOrder === 'ASC' ? '‚ñ≤' : '‚ñº' }}
            </span>
          </th>
          <th>Autor</th>
          <th>G√©nero</th>
          <th>Editorial</th>
          <th (click)="sortByField('price')" class="sortable">
            Precio
            <span class="sort-icon" *ngIf="sortBy === 'price'">
              {{ sortOrder === 'ASC' ? '‚ñ≤' : '‚ñº' }}
            </span>
          </th>
          <th (click)="sortByField('stock')" class="sortable">
            Stock
            <span class="sort-icon" *ngIf="sortBy === 'stock'">
              {{ sortOrder === 'ASC' ? '‚ñ≤' : '‚ñº' }}
            </span>
          </th>
          <th>Disponible</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let book of books">
          <td>{{ book.title }}</td>
          <td>{{ book.author.name }}</td>
          <td>{{ book.genre.name }}</td>
          <td>{{ book.publisher.name }}</td>
          <td>${{ book.price }}</td>
          <td>{{ book.stock }}</td>
          <td>
            <span class="badge" [class.badge-success]="book.available" [class.badge-danger]="!book.available">
              {{ book.available ? 'S√≠' : 'No' }}
            </span>
          </td>
          <td>
            <div class="actions">
              <button class="btn btn-sm btn-info" (click)="viewBook(book.id)" title="Ver">
                üëÅÔ∏è
              </button>
              <button class="btn btn-sm btn-warning" (click)="editBook(book.id)" title="Editar">
                ‚úèÔ∏è
              </button>
              <button class="btn btn-sm btn-danger" (click)="deleteBook(book.id)" title="Eliminar">
                üóëÔ∏è
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="no-data" *ngIf="!loading && books.length === 0">
      No se encontraron libros
    </div>

    <!-- Paginaci√≥n -->
    <div class="pagination" *ngIf="!loading && books.length > 0">
      <button
        class="btn btn-sm"
        [disabled]="currentPage === 1"
        (click)="goToPage(currentPage - 1)"
      >
        Anterior
      </button>

      <span class="page-info">
        P√°gina {{ currentPage }} de {{ totalPages }} ({{ totalItems }} registros)
      </span>

      <button
        class="btn btn-sm"
        [disabled]="currentPage === totalPages"
        (click)="goToPage(currentPage + 1)"
      >
        Siguiente
      </button>
    </div>
  </div>
</div>
